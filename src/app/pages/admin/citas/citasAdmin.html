<div class="container mx-auto p-6">
  <h2 class="text-2xl font-bold mb-8 text-center text-gray-800">Citas Pendientes y Confirmadas</h2>


  <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6">
    <div 
      *ngFor="let cita of citas" 
      class="bg-white rounded-2xl shadow-sm hover:shadow-xl transition-all duration-300 border border-cyan-200 flex flex-col overflow-hidden group"
    >

      <div class="px-6 py-4 bg-linear-to-r from-cyan-50 to-blue-50 border-b-2 border-cyan-400 flex justify-between items-center">
        <span class="text-sm font-semibold text-cyan-700">Cita #{{ cita.id }}</span>
        <span 
          class="px-3 py-1.5 rounded-full text-xs font-bold uppercase tracking-wider"
          [ngClass]="{
            'bg-yellow-100 text-yellow-800': cita.estado === 'pendiente',
            'bg-cyan-100 text-cyan-800': cita.estado === 'confirmada'
          }"
        >
          {{ cita.estado }}
        </span>
      </div>


      <div class="p-6 space-y-5 flex-1">

        <div class="flex items-center gap-4">
          <div class="w-12 h-12 bg-linear-to-br from-cyan-500 to-blue-600 rounded-full flex items-center justify-center text-white font-bold text-xl shadow-lg ring-4 ring-cyan-100">
            {{ cita.nombreMascota.charAt(0).toUpperCase() }}
          </div>
          <div>
            <p class="font-bold text-lg text-gray-900">{{ cita.nombreMascota }}</p>
            <p class="text-xs text-cyan-600 font-medium">Mascota</p>
          </div>
        </div>

        <div class="text-center py-4 bg-cyan-50 rounded-xl">
          <p class="text-4xl font-extrabold text-gray-800 leading-tight">
            {{ cita.fecha | appFechaFormato:'dia' }}
            <span class="text-2xl font-bold text-cyan-600 ml-2">
              {{ cita.fecha | appFechaFormato:'mes' | slice:0:3 }}
            </span>
          </p>
          <p class="text-lg font-semibold text-gray-600 mt-1">
            {{ cita.fecha | appFechaFormato:'anio' }}
          </p>
        </div>

        <div class="text-center -mt-2">
          <p class="text-3xl font-bold text-cyan-700">{{ cita.hora }}</p>
          <p class="text-sm text-gray-500 font-medium">Hora programada</p>
        </div>

        <div class="space-y-3 text-sm border-t-2 border-dashed border-cyan-200 pt-4">
          <div class="flex justify-between">
            <span class="text-gray-600 font-medium">Dueño</span>
            <span class="font-semibold text-gray-800">{{ cita.nombreDueno }}</span>
          </div>
          <div class="flex justify-between">
            <span class="text-gray-600 font-medium">Servicio</span>
            <span class="font-semibold text-gray-800">{{ cita.servicio }}</span>
          </div>
        </div>
      </div>

      <div class="px-6 py-5 bg-linear-to-r from-cyan-50 to-white border-t-2 border-cyan-300 flex flex-wrap gap-3 justify-center mt-auto">
        <button 
          *ngIf="cita.estado === 'pendiente'"
          (click)="actualizarEstado(cita.id!, estados.confirmada)"
          class="px-6 py-3 bg-cyan-600 hover:bg-cyan-700 text-white text-sm font-bold rounded-xl transition-all shadow-md hover:shadow-lg transform hover:-translate-y-1">
          Confirmar
        </button>

        <button 
          *ngIf="cita.estado === 'confirmada'"
          (click)="abrirModalCompletar(cita.id!)"
          class="px-6 py-3 bg-green-600 hover:bg-green-700 text-white text-sm font-bold rounded-xl transition-all shadow-md hover:shadow-lg transform hover:-translate-y-1">
          Completar
        </button>

        <button 
          *ngIf="cita.estado === 'pendiente' || cita.estado === 'confirmada'"
          (click)="actualizarEstado(cita.id!, estados.cancelada)"
          class="px-6 py-3 bg-red-600 hover:bg-red-700 text-white text-sm font-bold rounded-xl transition-all shadow-md hover:shadow-lg transform hover:-translate-y-1">
          Cancelar
        </button>
      </div>
    </div>
  </div>

  <div *ngIf="citas.length === 0" class="text-center py-16">
    <div class="bg-cyan-50 border-2 border-dashed border-cyan-300 rounded-3xl p-12 max-w-md mx-auto">
      <p class="text-cyan-700 text-xl font-bold">¡Todo al día!</p>
      <p class="text-gray-600 text-sm mt-2">No hay citas pendientes o confirmadas</p>
    </div>
  </div>
</div>

<div *ngIf="mostrarModal" class="fixed inset-0 bg-black bg-opacity-50 backdrop-blur-sm flex items-center justify-center z-50 p-4">
  <div class="bg-white rounded-3xl shadow-2xl p-8 w-full max-w-md border-2 border-cyan-200">
    <h3 class="text-2xl font-bold mb-6 text-center bg-linear-to-r from-cyan-600 to-blue-600 bg-clip-text text-transparent">
      Completar Cita
    </h3>

    <form [formGroup]="formDiagnostico" (ngSubmit)="completarCita()">
      <div class="mb-6">
        <label class="block text-sm font-bold text-gray-700 mb-2">Diagnóstico</label>
        <textarea
          class="w-full border-2 border-cyan-200 rounded-xl p-4 focus:ring-4 focus:ring-cyan-100 focus:border-cyan-500 transition-all resize-none"
          rows="6"
          formControlName="diagnostico"
          placeholder="Escribe aquí el diagnóstico completo..."></textarea>
      </div>

      <div class="flex justify-end gap-4">
        <button 
          type="button" 
          (click)="cerrarModal()" 
          class="px-6 py-3 bg-gray-200 hover:bg-gray-300 text-gray-800 rounded-xl font-bold transition">
          Cancelar
        </button>
        <button 
          type="submit" 
          [disabled]="formDiagnostico.invalid" 
          class="px-8 py-3 bg-linear-to-r from-cyan-600 to-cyan-700 hover:from-cyan-700 hover:to-cyan-800 disabled:from-gray-400 disabled:to-gray-500 text-white rounded-xl font-bold transition shadow-lg transform hover:scale-105">
          Guardar Diagnóstico
        </button>
      </div>
    </form>
  </div>
</div>